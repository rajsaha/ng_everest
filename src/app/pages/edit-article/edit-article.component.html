<mat-progress-bar
  *ngIf="isLoading"
  mode="indeterminate"
>
</mat-progress-bar>
<form [formGroup]="editArticleForm">
    <div class="section-container">
      <div class="section">
        <div class="section-content">
          <textarea
            autosize
            style="height: 50px"
            matInput
            placeholder="Title"
            formControlName="title"
            class="input-title"
          ></textarea>
          <mat-error
            *ngIf="
              editArticleFormControls.title.hasError('required') &&
              editArticleFormControls.title.dirty
            "
          >
            Please enter title
          </mat-error>
  
          <div class="editor-container">
            <editor
              id="tinyeditor"
              initialValue=""
              [apiKey]="apiKey"
              [init]="tinyMceInit"
              formControlName="description"
            ></editor>
            <mat-error
              *ngIf="
                editArticleFormControls.description.hasError('required') &&
                editArticleFormControls.description.dirty
              "
            >
              Your article can't be empty!
            </mat-error>
          </div>
        </div>
      </div>
    </div>
  
    <div class="section-container">
      <div class="section">
        <div class="section-header">
          <h4>Decorate your article</h4>
        </div>
        <div class="section-content">
          <mat-form-field appearance="outline">
            <mat-label>Add tags to your article</mat-label>
            <mat-chip-list #chipList aria-label="Interest selection">
              <mat-chip
                *ngFor="let tag of tags"
                [selectable]="selectable"
                [removable]="removable"
                (removed)="removeTag(tag)"
              >
                {{ tag }}
                <mat-icon matChipRemove *ngIf="removable">cancel</mat-icon>
              </mat-chip>
              <input
                placeholder="Tag"
                [matChipInputFor]="chipList"
                [matChipInputSeparatorKeyCodes]="separatorKeysCodes"
                [matChipInputAddOnBlur]="addOnBlur"
                (matChipInputTokenEnd)="addTag($event)"
              />
            </mat-chip-list>
          </mat-form-field>
  
          <mat-form-field *ngIf="!editArticleFormControls.isCustomImage.value" appearance="outline">
            <mat-label>Give your article an image</mat-label>
            <input matInput placeholder="Link to image" formControlName="image" />
            <mat-error
              *ngIf="
                editArticleFormControls.image.hasError('imageUrlInvalid') &&
                editArticleFormControls.image.dirty
              "
            >
              Please enter a link that ends with .jpg / .png or similar
            </mat-error>
          </mat-form-field>
  
          <div class="mat-checkbox-container">
            <mat-checkbox formControlName="isCustomImage"
              >Upload custom feature image</mat-checkbox
            >
          </div>
  
          <div
            class="custom-image"
            (click)="imageInput.click()"
            matRipple
            *ngIf="editArticleFormControls.isCustomImage.value"
            [ngStyle]="{ 'background-image': 'url(' + customImage + ')' }"
          >
            <p *ngIf="!customImage">
              <fa-icon [icon]="faUpload"></fa-icon>&nbsp;Click here to upload a
              custom image
            </p>
            <div
              *ngIf="customImage"
              class="remove"
              (click)="removeImage('customImage')"
              matRipple
            >
              <fa-icon [icon]="faTrashAlt"></fa-icon>
            </div>
            <input
              hidden
              (change)="onFileSelected(imageInput)"
              #imageInput
              type="file"
              accept="image/*"
            />
          </div>
  
          <div
            *ngIf="
              image &&
              !editArticleFormControls.isCustomImage.value &&
              editArticleFormControls.image.valid
            "
            class="resource-image"
            [ngStyle]="{ 'background-image': 'url(' + image + ')' }"
          >
            <div class="remove" (click)="removeImage('image')" matRipple>
              <fa-icon [icon]="faTrashAlt"></fa-icon>
            </div>
          </div>
  
          <h6>Add to collection</h6>
          <mat-form-field appearance="outline">
            <mat-label>Collections</mat-label>
            <input type="text" placeholder="Select or Create New" matInput [matAutocomplete]="auto" formControlName="collectionName">
            <mat-autocomplete #auto="matAutocomplete">
              <mat-optgroup label="Existing Collections">
                <mat-option *ngFor="let collection of collections" [value]="collection.title">
                  {{ collection.title }}
                </mat-option>
              </mat-optgroup>
            </mat-autocomplete>
          </mat-form-field>
  
          <div class="form-button-container">
            <app-custom-button
              [buttonLabel]="saveButtonText"
              [isDisabled]="isDisabled"
              [isLoading]="isLoading"
              (click)="submitEditArticleForm()"
              size="small"
            ></app-custom-button>
          </div>
        </div>
      </div>
    </div>
  </form>
  