<mat-progress-bar mode="query" *ngIf="isLoading"></mat-progress-bar>
<div class="section-container">
  <div class="section">
    <div class="section-header">
      <h4>Share a Resource</h4>
    </div>

    <div class="section-content">
      <div class="custom-image" (click)="imageInput.click()" matRipple
        *ngIf="shareResourceForm.controls.isCustomImage.value" [ngStyle]="{ 'background-image': 'url(' + image ? image : '' + ')' }">
        <p *ngIf="!image">
          <fa-icon [icon]="faUpload"></fa-icon>&nbsp;Click here to upload a custom image
        </p>
        <input hidden (change)="onFileSelected(imageInput)" #imageInput type="file" accept="image/*">
      </div>

      <div class="resource-image" *ngIf="!shareResourceForm.controls.isCustomImage.value"
        [ngStyle]="{ 'background-image': 'url(' + ogImage + ')' }">
        <p *ngIf="!ogImage">
          If your link has an <a href="http://ogp.me/" target="_blank">Open Graph</a> image, it'll appear here
        </p>
      </div>


      <form [formGroup]="shareResourceForm" (ngSubmit)="submitShareResourceForm()">
        <div class="mat-checkbox-container">
          <mat-checkbox formControlName="isCustomImage">Use custom image</mat-checkbox>
        </div>
        <mat-form-field appearance="outline">
          <mat-label>Link</mat-label>
          <input matInput placeholder="Paste your link here" formControlName="url">
          <mat-error *ngIf="shareResourceFormControls.url.hasError('urlInvalid') && shareResourceFormControls.url.dirty">
            Invalid link
          </mat-error>
        </mat-form-field>

        <mat-form-field appearance="outline">
          <mat-label>Title</mat-label>
          <input matInput placeholder="Give it a title" formControlName="title">

          <mat-error *ngIf="shareResourceFormControls.title.hasError('required') && shareResourceFormControls.title.dirty">
            Title required
          </mat-error>
        </mat-form-field>

        <mat-form-field appearance="outline">
          <mat-label>Description</mat-label>
          <textarea matInput placeholder="Say something about it" formControlName="description"></textarea>

          <mat-error *ngIf="shareResourceFormControls.description.hasError('required') && shareResourceFormControls.description.dirty">
            Description required
          </mat-error>
        </mat-form-field>

        <mat-form-field appearance="outline">
          <mat-label>Tags</mat-label>
          <mat-chip-list #chipList aria-label="Tags">
            <mat-chip *ngFor="let tag of tags" [selectable]="selectable" [removable]="removable"
              (removed)="removeTag(tag)">
              {{ tag }}
              <mat-icon matChipRemove *ngIf="removable">cancel</mat-icon>
            </mat-chip>
            <input placeholder="Add tags that best fit" [matChipInputFor]="chipList"
              [matChipInputSeparatorKeyCodes]="separatorKeysCodes" [matChipInputAddOnBlur]="addOnBlur"
              (matChipInputTokenEnd)="addTag($event)">
          </mat-chip-list>
        </mat-form-field>

        <div class="form-button-container clearfix">
          <app-custom-button [buttonLabel]="submitButtonText" [isDisabled]="isDisabled" [isLoading]="isLoading" size="small"></app-custom-button>
        </div>
      </form>
    </div>
  </div>
</div>
